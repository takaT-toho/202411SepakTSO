CREATE DATABASE IF NOT EXISTS sendai;
use sendai;

-- コートのテーブルを作成します。
CREATE TABLE COURT (
    COURTID INT PRIMARY KEY,
    NAME VARCHAR (10) NOT NULL,
    PASS VARCHAR (10) NOT NULL,
    SESSIONID VARCHAR (256),
    LASTUPDATE BIGINT
);

INSERT INTO COURT VALUES (1, 'A', '12341', NULL, 0);
INSERT INTO COURT VALUES (2, 'B', '12342', NULL, 0);


-- ユーザーのテーブルを作成します。
-- TEAMIDの命名規則
-- 北海道：100番台
-- 東北：200番台
-- 関東：300番台
-- 北陸・甲信越：400番台
-- 東海：500番台
-- 近畿：600番台
-- 中国・四国：700番台
-- 九州・沖縄：800番台

CREATE TABLE TEAM (
    TEAMID INT PRIMARY KEY,
    NAME VARCHAR (20) NOT NULL,
    REPRESENTATIVE VARCHAR (20),
    EMAIL VARCHAR (256)
);

INSERT INTO TEAM VALUES (100, '北海道セパタクロー', '北海道太郎', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (200, '東北セパタクロー', '東北太郎', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (300, '関東セパタクロー', '関東太郎', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (400, '北陸甲信越セパタクロー', '北陸甲信', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (500, '東海セパタクロー', '東海太郎', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (600, '近畿セパタクロー', '近畿太郎', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (700, '中国四国セパタクロー', '中国四国', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (800, '九州沖縄セパタクロー', '九州沖縄', 'xxxx@xxxxxx.com');
INSERT INTO TEAM VALUES (900, '運営', '運営', 'xxxx@xxxxxx.com');


-- レグのテーブルを作成します。
-- レグ名命名規則
-- TEAMID+連番

CREATE TABLE REGU (
    REGUID INT PRIMARY KEY,
    TEAMID INT NOT NULL,
    FOREIGN KEY (TEAMID) REFERENCES TEAM(TEAMID) ON DELETE CASCADE,
    NAME VARCHAR (10) NOT NULL,
    ABBREVIATION VARCHAR (10) NOT NULL,
    DEPARTMENT VARCHAR (10) NOT NULL
);

INSERT INTO REGU VALUES (10000, 100, '北北Aチーム', '北北A', 'アスリート');
INSERT INTO REGU VALUES (10001, 100, '北北Bチーム', '北北B', 'アスリート');
INSERT INTO REGU VALUES (10002, 100, '北北Cチーム', '北北C', 'エンジョイ');
INSERT INTO REGU VALUES (20000, 200, '東東Aチーム', '東東A', 'アスリート');
INSERT INTO REGU VALUES (20001, 200, '東東Bチーム', '東東B', 'アスリート');
INSERT INTO REGU VALUES (30000, 300, '関関Aチーム', '関関A', 'アスリート');
INSERT INTO REGU VALUES (40000, 400, '陸陸Aチーム', '陸陸A', 'アスリート');
INSERT INTO REGU VALUES (50000, 500, '海海Aチーム', '海海A', 'エンジョイ');
INSERT INTO REGU VALUES (60000, 600, '近々Aチーム', '近々A', 'エンジョイ');
INSERT INTO REGU VALUES (90000, 900, '運営', '::A9勝者', 'エンジョイ');
INSERT INTO REGU VALUES (90001, 900, '運営', '::B9勝者', 'エンジョイ');


-- プレイヤーマスタのテーブルを作成します。
CREATE TABLE PLAYERMASTER (
    PLAYERMASTERID INT PRIMARY KEY,
    TEAMID INT NOT NULL,
    FOREIGN KEY (TEAMID) REFERENCES TEAM(TEAMID) ON DELETE CASCADE,
    NAME VARCHAR (20) NOT NULL,
    KATAKANA VARCHAR (20) NOT NULL,
    EXPERIENCE VARCHAR (20) NOT NULL
);

INSERT INTO PLAYERMASTER VALUES (1000001, 100, '北海 太郎', 'ホッカイ タロウ', 'セパ歴10年');
INSERT INTO PLAYERMASTER VALUES (1000002, 100, '北海 次郎', 'ホッカイ ジロウ', 'セパ歴8年');
INSERT INTO PLAYERMASTER VALUES (1000003, 100, '北海 三郎', 'ホッカイ サブロウ', 'セパ歴6年');
INSERT INTO PLAYERMASTER VALUES (1000004, 100, '北海 四郎', 'ホッカイ シロウ', 'セパ歴4年');
INSERT INTO PLAYERMASTER VALUES (1000005, 100, '北海 五郎', 'ホッカイ ゴロウ', 'セパ歴2年');
INSERT INTO PLAYERMASTER VALUES (1000006, 100, '北海 六郎', 'ホッカイ ロクロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (1000007, 100, '北海 七郎', 'ホッカイ シチロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (1000008, 100, '北海 八郎', 'ホッカイ ハチロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (1000009, 100, '北海 九郎', 'ホッカイ クロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (2000001, 200, '東北 太郎', 'トウホク タロウ', 'セパ歴10年');
INSERT INTO PLAYERMASTER VALUES (2000002, 200, '東北 次郎', 'トウホク ジロウ', 'セパ歴7年');
INSERT INTO PLAYERMASTER VALUES (2000003, 200, '東北 三郎', 'トウホク サブロウ', 'セパ歴5年');
INSERT INTO PLAYERMASTER VALUES (2000004, 200, '東北 四郎', 'トウホク シロウ', 'セパ歴3年');
INSERT INTO PLAYERMASTER VALUES (2000005, 200, '東北 五郎', 'トウホク ゴロウ', 'セパ歴2年');
INSERT INTO PLAYERMASTER VALUES (2000006, 200, '東北 六郎', 'トウホク ロクロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (3000001, 300, '関東 太郎', 'カントウ タロウ', 'セパ歴10年');
INSERT INTO PLAYERMASTER VALUES (3000002, 300, '関東 次郎', 'カントウ ジロウ', 'セパ歴7年');
INSERT INTO PLAYERMASTER VALUES (3000003, 300, '関東 三郎', 'カントウ サブロウ', 'セパ歴4年');
INSERT INTO PLAYERMASTER VALUES (4000001, 400, '北陸 甲信', 'ホクリク コウシン', 'セパ歴10年');
INSERT INTO PLAYERMASTER VALUES (4000002, 400, '北陸 次郎', 'ホクリク ジロウ', 'セパ歴7年');
INSERT INTO PLAYERMASTER VALUES (4000003, 400, '北陸 三郎', 'ホクリク サブロウ', 'セパ歴4年');
INSERT INTO PLAYERMASTER VALUES (5000001, 500, '東海 太郎', 'トウカイ タロウ', 'セパ歴10年');
INSERT INTO PLAYERMASTER VALUES (5000002, 500, '東海 次郎', 'トウカイ ジロウ', 'セパ歴7年');
INSERT INTO PLAYERMASTER VALUES (5000003, 500, '東海 三郎', 'トウカイ サブロウ', 'セパ歴4年');
INSERT INTO PLAYERMASTER VALUES (6000001, 600, '近畿 一郎', 'キンキ イチロウ', 'セパ歴1年');
INSERT INTO PLAYERMASTER VALUES (6000002, 600, '近畿 二郎', 'キンキ ジロウ', 'セパ歴2年');
INSERT INTO PLAYERMASTER VALUES (6000003, 600, '近畿 三郎', 'キンキ サブロウ', 'セパ歴3年');
INSERT INTO PLAYERMASTER VALUES (6000004, 600, '近畿 四郎', 'キンキ シロウ', 'セパ歴4年');
INSERT INTO PLAYERMASTER VALUES (6000005, 600, '近畿 五郎', 'キンキ シロウ', 'セパ歴5年');


-- プレイヤーのテーブルを作成します。
-- 選手ID命名規則
-- TEAMID + 連番

CREATE TABLE PLAYER (
    PLAYERID INT PRIMARY KEY,
    REGUID INT NOT NULL,
    FOREIGN KEY (REGUID) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    PLAYERMASTERID INT NOT NULL,
    FOREIGN KEY (PLAYERMASTERID) REFERENCES PLAYERMASTER(PLAYERMASTERID) ON DELETE CASCADE,
    POSITION VARCHAR (10) NOT NULL,
    ORDERS INT NOT NULL
);

INSERT INTO PLAYER VALUES (100011, 10000, 1000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (100012, 10000, 1000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (100013, 10000, 1000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (100021, 10001, 1000004, 'サーバー', 1);
INSERT INTO PLAYER VALUES (100022, 10001, 1000005, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (100023, 10001, 1000006, 'トサー', 3);
INSERT INTO PLAYER VALUES (100031, 10002, 1000007, 'サーバー', 1);
INSERT INTO PLAYER VALUES (100032, 10002, 1000008, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (100033, 10002, 1000009, 'トサー', 3);
INSERT INTO PLAYER VALUES (200001, 20000, 2000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (200002, 20000, 2000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (200003, 20000, 2000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (200011, 20001, 2000004, 'サーバー', 1);
INSERT INTO PLAYER VALUES (200012, 20001, 2000005, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (200013, 20001, 2000006, 'トサー', 3);
INSERT INTO PLAYER VALUES (300001, 30000, 3000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (300002, 30000, 3000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (300003, 30000, 3000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (400001, 40000, 4000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (400002, 40000, 4000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (400003, 40000, 4000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (500001, 50000, 5000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (500002, 50000, 5000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (500003, 50000, 5000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (600001, 60000, 6000001, 'サーバー', 1);
INSERT INTO PLAYER VALUES (600002, 60000, 6000002, 'アタッカー', 2);
INSERT INTO PLAYER VALUES (600003, 60000, 6000003, 'トサー', 3);
INSERT INTO PLAYER VALUES (600004, 60000, 6000004, 'サーバー', 4);
INSERT INTO PLAYER VALUES (600005, 60000, 6000005, 'アタッカー', 5);


-- ゲーム履歴のテーブルを作成します。
CREATE TABLE GAMEEVENTHISTORY (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    GAMEID INT NOT NULL,
    SETNUM INT NOT NULL,
    TYPE VARCHAR (20) NOT NULL,
    FIRSTDETAIL VARCHAR (20) NOT NULL,
    SECONDDETAIL VARCHAR (20),
    ISSEQUENTIAL BOOLEAN NOT NULL,
    ISAREGUGOT BOOLEAN NOT NULL,
    CREATEDAT TIMESTAMP NOT NULL
);

-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'ADDPOINTS', '1', FALSE, TRUE, CURRENT_TIMESTAMP);
-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'TIMEOUT', '1', FALSE, TRUE, CURRENT_TIMESTAMP);
-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, SECONDDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'PLAYERSUBSTITUTION', '選手A', '選手B', FALSE, TRUE, CURRENT_TIMESTAMP);
-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'ADDPOINTS', '1', FALSE, FALSE, CURRENT_TIMESTAMP);
-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'ADDPOINTS', '2', FALSE, TRUE, CURRENT_TIMESTAMP);
-- INSERT INTO GAMEEVENTHISTORY (GAMEID, SETNUM, TYPE, FIRSTDETAIL, ISSEQUENTIAL, ISAREGUGOT, CREATEDAT) VALUES (11, 1, 'ADDPOINTS', '3', TRUE, TRUE, CURRENT_TIMESTAMP);



-- ゲーム詳細のテーブルを作成します。
CREATE TABLE gameDetail (
    gameId INT PRIMARY KEY,
    is1setGotByA BOOLEAN,
    is2setGotByA BOOLEAN,
    is3setGotByA BOOLEAN,
    points1setA INT,
    points2setA INT,
    points3setA INT,
    points1setB INT,
    points2setB INT,
    points3setB INT,
    normalTimeoutRemainA INT,
    technicalTimeoutRemainA INT,
    normalTimeoutRemainB INT,
    technicalTimeoutRemainB INT,
    playerSubstitutionRemainA INT,
    playerSubstitutionRemainB INT,
    is3setCourtChanged BOOLEAN,
    sumPoints INT
);

INSERT INTO gameDetail VALUES (
    101,
    NULL,
    NULL,
    NULL,
    0,
    0,
    0,
    0,
    0,
    0,
    1,
    5,
    1,
    5,
    2,
    2,
    FALSE,
    0
);
INSERT INTO gameDetail VALUES (
    102,
    NULL,
    NULL,
    NULL,
    0,
    0,
    0,
    0,
    0,
    0,
    1,
    5,
    1,
    5,
    2,
    2,
    FALSE,
    0
);



-- ゲーム設定のテーブルを作成します。
CREATE TABLE gameConfig (
    gameId INT PRIMARY KEY,
    gameType VARCHAR(255),
    gameRule VARCHAR(255),
    isAreguTossWin BOOLEAN,
    isAreguFirstServe BOOLEAN,
    isAreguLeft BOOLEAN,
    language INT,
    maxScore1set INT,
    maxScore2set INT,
    maxScore3set INT,
    deuceStartScore1set INT,
    deuceStartScore2set INT,
    deuceStartScore3set INT,
    deuceDifference1set INT,
    deuceDifference2set INT,
    deuceDifference3set INT,
    courtChangeScore INT,
    maxSet INT
);

INSERT INTO gameConfig VALUES (101, 'レグ', '先取', true, true, true, 0, 25, 25, 25, 20, 20, 20, 2, 2, 2, 11, 3);
INSERT INTO gameConfig VALUES (102, 'レグ', '先取', true, true, true, 0, 25, 25, 25, 20, 20, 20, 2, 2, 2, 11, 3);


-- ゲームのテーブルを作成します。
CREATE TABLE GAME(
    GAMEID INT PRIMARY KEY,
    NAME VARCHAR (10) NOT NULL,
    PASS VARCHAR (10) NOT NULL,
    ROUND VARCHAR (10) NOT NULL,
    TIME VARCHAR (10) NOT NULL,
    COURTID INT NOT NULL,
    FOREIGN KEY (COURTID) REFERENCES COURT(COURTID) ON DELETE CASCADE,
    AREGUID INT,
    FOREIGN KEY (AREGUID) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    BREGUID INT,
    FOREIGN KEY (BREGUID) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    MAINJUDGEREGUID INT,
    FOREIGN KEY (MAINJUDGEREGUID) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    SUBJUDGEREGUID INT,
    FOREIGN KEY (SUBJUDGEREGUID) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    SETNOW INT NOT NULL,
    NEXTGAMEIDWINNER INT,
    NEXTGAMEIDLOSER INT,
    ISSTARTED BOOLEAN NOT NULL,
    ISFINISHED BOOLEAN NOT NULL,
    ISFIN1SET BOOLEAN NOT NULL,
    ISFIN2SET BOOLEAN NOT NULL,
    ISFIN3SET BOOLEAN NOT NULL,
    SETNUMGOTBYA INT NOT NULL,
    SETNUMGOTBYB BOOLEAN NOT NULL,
    MAINJUDGESIGN VARCHAR (20),
    WINNER INT,
    FOREIGN KEY (WINNER) REFERENCES REGU(REGUID) ON DELETE CASCADE,
    LOSER INT,
    FOREIGN KEY (LOSER) REFERENCES REGU(REGUID) ON DELETE CASCADE,

);

INSERT INTO GAME VALUES (
101, 'A1', '123411', '#1', '10:00', 1, 10000, 20000, 30000, 40000, 1,
201, 301, FALSE, FALSE, FALSE, FALSE, FALSE, 0, 0, NULL, NULL, NULL);
INSERT INTO GAME VALUES (
102, 'B1', '123412', '#1', '10:00', 2, 50000, 60000, 30000, 40000, 1,
201, 301, FALSE, FALSE, FALSE, FALSE, FALSE, 0, 0, NULL, NULL, NULL);
INSERT INTO GAME VALUES (
201, 'A2', '123411', '#2', '11:00', 1, 90000, 90001, 30000, 40000, 1,
201, 301, FALSE, FALSE, FALSE, FALSE, FALSE, 0, 0, NULL, NULL, NULL);
INSERT INTO GAME VALUES (
301, 'A3', '123411', '#3', '12:00', 1, 90000, 90001, 30000, 40000, 1,
201, 301, FALSE, FALSE, FALSE, FALSE, FALSE, 0, 0, NULL, NULL, NULL);